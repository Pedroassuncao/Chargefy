{"ast":null,"code":"import _regeneratorRuntime from\"/home/pedro/Documents/ULP/Chargefy2/Chargefy2.0/web/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/pedro/Documents/ULP/Chargefy2/Chargefy2.0/web/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/pedro/Documents/ULP/Chargefy2/Chargefy2.0/web/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{Map,Marker,TileLayer}from'react-leaflet';import{FiPlus}from'react-icons/fi';import'../styles/pages/create-pce.css';import Sidebar from'../components/Sidebar';import mapIcon from'../utils/mapIcon';import api from'../services/api';import{useHistory}from'react-router-dom';export default function CreatePce(){var _useState=useState({latitude:0,longitude:0}),_useState2=_slicedToArray(_useState,2),userPosition=_useState2[0],setUserPosition=_useState2[1];navigator.geolocation.getCurrentPosition(function(position){setUserPosition({latitude:position.coords.latitude,longitude:position.coords.longitude});});var history=useHistory();var _useState3=useState({latitude:0,longitude:0}),_useState4=_slicedToArray(_useState3,2),position=_useState4[0],setPosition=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),name=_useState6[0],setName=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),about=_useState8[0],setAbout=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),charger_type=_useState10[0],setChargerType=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),opening_hours=_useState12[0],setOpeningHours=_useState12[1];// const [open_on_weekends, setOpenOnWeekends] = useState(true);\nvar _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),images=_useState14[0],setImages=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),previewImages=_useState16[0],setPreviewImages=_useState16[1];function handleMapClick(event){var _event$latlng=event.latlng,lat=_event$latlng.lat,lng=_event$latlng.lng;setPosition({latitude:lat,longitude:lng});}function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){var latitude,longitude,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();latitude=position.latitude,longitude=position.longitude;data=new FormData();data.append('name',name);data.append('latitude',String(latitude));data.append('longitude',String(longitude));data.append('about',about);data.append('charger_type',charger_type);data.append('opening_hours',opening_hours);// data.append('open_on_weekends', String(open_on_weekends));\nimages.forEach(function(image){data.append('images',image);});_context.next=12;return api.post('/pces',data);case 12:history.push('/success');case 13:case\"end\":return _context.stop();}}},_callee);}));return _handleSubmit.apply(this,arguments);}function handleSelectImages(event){if(!event.target.files){return;}var selectedImages=Array.from(event.target.files);setImages(selectedImages);var selectedImagesPreview=selectedImages.map(function(image){return URL.createObjectURL(image);});setPreviewImages(selectedImagesPreview);}return/*#__PURE__*/React.createElement(\"div\",{id:\"page-create-pce\"},/*#__PURE__*/React.createElement(Sidebar,null),/*#__PURE__*/React.createElement(\"main\",null,/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit,className:\"create-pce-form\"},/*#__PURE__*/React.createElement(\"fieldset\",null,/*#__PURE__*/React.createElement(\"legend\",null,\"Inserir dados do Posto\"),/*#__PURE__*/React.createElement(Map,{center:[userPosition.latitude,userPosition.longitude],style:{width:'100%',height:280},zoom:13,onClick:handleMapClick},/*#__PURE__*/React.createElement(TileLayer// url = \"https://a.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n,{url:\"https://api.mapbox.com/styles/v1/mapbox/outdoors-v11/tiles/256/{z}/{x}/{y}@2x?access_token=\".concat(process.env.REACT_APP_MAPBOX_TOKEN)}),position.latitude!==0&&/*#__PURE__*/React.createElement(Marker,{interactive:false,icon:mapIcon,position:[position.latitude,position.longitude]})),/*#__PURE__*/React.createElement(\"div\",{className:\"input-block\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"name\"},\"Nome\"),/*#__PURE__*/React.createElement(\"input\",{id:\"name\",value:name,onChange:function onChange(e){return setName(e.target.value);}})),/*#__PURE__*/React.createElement(\"div\",{className:\"input-block\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"about\"},\"Sobre \",/*#__PURE__*/React.createElement(\"span\",null,\"M\\xE1ximo de 300 caracteres\")),/*#__PURE__*/React.createElement(\"textarea\",{id:\"name\",maxLength:300,value:about,onChange:function onChange(e){return setAbout(e.target.value);}})),/*#__PURE__*/React.createElement(\"div\",{className:\"input-block\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"images\"},\"Fotos\"),/*#__PURE__*/React.createElement(\"div\",{className:\"images-container\"},previewImages.map(function(image){return/*#__PURE__*/React.createElement(\"img\",{key:image,src:image,alt:name});}),/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"image[]\",className:\"new-image\"},/*#__PURE__*/React.createElement(FiPlus,{size:24,color:\"#15D691\"}))),/*#__PURE__*/React.createElement(\"input\",{multiple:true,onChange:handleSelectImages,type:\"file\",id:\"image[]\"}))),/*#__PURE__*/React.createElement(\"fieldset\",null,/*#__PURE__*/React.createElement(\"legend\",null,\"Detalhes do carregador\"),/*#__PURE__*/React.createElement(\"div\",{className:\"input-block\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"instructions\"},\"Tipo de carregador\"),/*#__PURE__*/React.createElement(\"textarea\",{id:\"instructions\",value:charger_type,onChange:function onChange(e){return setChargerType(e.target.value);}})),/*#__PURE__*/React.createElement(\"div\",{className:\"input-block\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"opening_hours\"},\"Hor\\xE1rio\"),/*#__PURE__*/React.createElement(\"input\",{id:\"opening_hours\",value:opening_hours,onChange:function onChange(e){return setOpeningHours(e.target.value);}}))),/*#__PURE__*/React.createElement(\"button\",{className:\"confirm-button\",type:\"submit\"},\"Confirmar\"))));}// return `https://a.tile.openstreetmap.org/${z}/${x}/${y}.png`;","map":{"version":3,"sources":["/home/pedro/Documents/ULP/Chargefy2/Chargefy2.0/web/src/views/CreatePce.tsx"],"names":["React","useState","Map","Marker","TileLayer","FiPlus","Sidebar","mapIcon","api","useHistory","CreatePce","latitude","longitude","userPosition","setUserPosition","navigator","geolocation","getCurrentPosition","position","coords","history","setPosition","name","setName","about","setAbout","charger_type","setChargerType","opening_hours","setOpeningHours","images","setImages","previewImages","setPreviewImages","handleMapClick","event","latlng","lat","lng","handleSubmit","preventDefault","data","FormData","append","String","forEach","image","post","push","handleSelectImages","target","files","selectedImages","Array","from","selectedImagesPreview","map","URL","createObjectURL","width","height","process","env","REACT_APP_MAPBOX_TOKEN","e","value"],"mappings":"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","sourcesContent":["import React, { FormEvent, useState, ChangeEvent } from 'react';\nimport { Map, Marker, TileLayer } from 'react-leaflet';\nimport { LeafletMouseEvent } from 'leaflet';\n\nimport { FiPlus } from 'react-icons/fi';\n\nimport '../styles/pages/create-pce.css';\nimport Sidebar from '../components/Sidebar';\nimport mapIcon from '../utils/mapIcon';\nimport api from '../services/api';\nimport { useHistory } from 'react-router-dom';\n\nexport default function CreatePce() {\n  const [userPosition, setUserPosition] = useState({\n    latitude: 0,\n    longitude: 0,\n  });\n\n  navigator.geolocation.getCurrentPosition((position) => {\n    setUserPosition({\n      latitude: position.coords.latitude,\n      longitude: position.coords.longitude,\n    });\n  });\n\n  const history = useHistory();\n\n  const [position, setPosition] = useState({ latitude: 0, longitude: 0 });\n\n  const [name, setName] = useState('');\n  const [about, setAbout] = useState('');\n  const [charger_type, setChargerType] = useState('');\n  const [opening_hours, setOpeningHours] = useState('');\n  // const [open_on_weekends, setOpenOnWeekends] = useState(true);\n  const [images, setImages] = useState<File[]>([]);\n  const [previewImages, setPreviewImages] = useState<string[]>([]);\n\n  function handleMapClick(event: LeafletMouseEvent) {\n    const { lat, lng } = event.latlng;\n    setPosition({\n      latitude: lat,\n      longitude: lng,\n    });\n  }\n\n  async function handleSubmit(event: FormEvent) {\n    event.preventDefault();\n\n    const { latitude, longitude } = position;\n\n    const data = new FormData();\n\n    data.append('name', name);\n    data.append('latitude', String(latitude));\n    data.append('longitude', String(longitude));\n    data.append('about', about);\n    data.append('charger_type', charger_type);\n    data.append('opening_hours', opening_hours);\n    // data.append('open_on_weekends', String(open_on_weekends));\n\n    images.forEach((image) => {\n      data.append('images', image);\n    });\n\n    await api.post('/pces', data);\n\n    history.push('/success');\n  }\n\n  function handleSelectImages(event: ChangeEvent<HTMLInputElement>) {\n    if (!event.target.files) {\n      return;\n    }\n    const selectedImages = Array.from(event.target.files);\n    setImages(selectedImages);\n\n    const selectedImagesPreview = selectedImages.map((image) => {\n      return URL.createObjectURL(image);\n    });\n\n    setPreviewImages(selectedImagesPreview);\n  }\n\n  return (\n    <div id=\"page-create-pce\">\n      <Sidebar />\n      <main>\n        <form onSubmit={handleSubmit} className=\"create-pce-form\">\n          <fieldset>\n            <legend>Inserir dados do Posto</legend>\n\n            <Map\n              center={[userPosition.latitude, userPosition.longitude]}\n              style={{ width: '100%', height: 280 }}\n              zoom={13}\n              onClick={handleMapClick}\n            >\n              <TileLayer\n              // url = \"https://a.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n                 url={`https://api.mapbox.com/styles/v1/mapbox/outdoors-v11/tiles/256/{z}/{x}/{y}@2x?access_token=${process.env.REACT_APP_MAPBOX_TOKEN}`}\n              />\n\n              {position.latitude !== 0 && (\n                <Marker\n                  interactive={false}\n                  icon={mapIcon}\n                  position={[position.latitude, position.longitude]}\n                />\n              )}\n            </Map>\n\n            <div className=\"input-block\">\n              <label htmlFor=\"name\">Nome</label>\n              <input\n                id=\"name\"\n                value={name}\n                onChange={(e) => setName(e.target.value)}\n              />\n            </div>\n\n            <div className=\"input-block\">\n              <label htmlFor=\"about\">\n                Sobre <span>Máximo de 300 caracteres</span>\n              </label>\n              <textarea\n                id=\"name\"\n                maxLength={300}\n                value={about}\n                onChange={(e) => setAbout(e.target.value)}\n              />\n            </div>\n\n            <div className=\"input-block\">\n              <label htmlFor=\"images\">Fotos</label>\n\n              <div className=\"images-container\">\n                {previewImages.map((image) => {\n                  return <img key={image} src={image} alt={name} />;\n                })}\n                <label htmlFor=\"image[]\" className=\"new-image\">\n                  <FiPlus size={24} color=\"#15D691\" />\n                </label>\n              </div>\n\n              <input\n                multiple\n                onChange={handleSelectImages}\n                type=\"file\"\n                id=\"image[]\"\n              />\n            </div>\n          </fieldset>\n\n          <fieldset>\n            <legend>Detalhes do carregador</legend>\n\n            <div className=\"input-block\">\n              <label htmlFor=\"instructions\">Tipo de carregador</label>\n              <textarea\n                id=\"instructions\"\n                value={charger_type}\n                onChange={(e) => setChargerType(e.target.value)}\n              />\n            </div>\n\n            <div className=\"input-block\">\n              <label htmlFor=\"opening_hours\">Horário</label>\n              <input\n                id=\"opening_hours\"\n                value={opening_hours}\n                onChange={(e) => setOpeningHours(e.target.value)}\n              />\n            </div>\n\n            {/* <div className=\"input-block\">\n              <label htmlFor=\"open_on_weekends\">Atende fim de semana</label>\n\n              <div className=\"button-select\">\n                <button\n                  type=\"button\"\n                  className={open_on_weekends ? 'active' : ''}\n                  onClick={() => setOpenOnWeekends(true)}\n                >\n                  Sim\n                </button>\n                <button\n                  type=\"button\"\n                  className={!open_on_weekends ? 'disactive' : ''}\n                  onClick={() => setOpenOnWeekends(false)}\n                >\n                  Não\n                </button>\n              </div>\n            </div> */}\n          </fieldset>\n\n          <button className=\"confirm-button\" type=\"submit\">\n            Confirmar\n          </button>\n        </form>\n      </main>\n    </div>\n  );\n}\n\n// return `https://a.tile.openstreetmap.org/${z}/${x}/${y}.png`;\n"]},"metadata":{},"sourceType":"module"}